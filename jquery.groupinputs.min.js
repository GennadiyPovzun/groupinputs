/**
 * GroupInputs v. 0.8.2
 * @author Pavel Kornilov <pk@ostrovok.ru> <lusever@lusever.com>
 * https://github.com/lusever/groupinputs
 * MIT Licensed
 */
(function(m){'use strict';
function p(j,h,a){var l;if(void 0!==h)j.setSelectionRange?j.setSelectionRange(h,a):document.selection&&document.selection.createRange&&(l=j.createTextRange(),l.collapse(!0),l.moveEnd("character",a),l.moveStart("character",h),l.select());else{a=h=0;if("selectionStart"in j)h=j.selectionStart,a=j.selectionEnd;else if(j.createTextRange){l=document.selection.createRange();var n=l.duplicate();l.parentElement()===j&&(h=-n.moveStart("character",-1E5),a=h+l.text.length)}return{start:h,end:a}}}var q="maxlength";
m.fn.groupinputs=function(){function j(g,d){var b=g[0].value,c=p(g[0]).end,e=b.slice(0,c),f=b.slice(c),j=d.a-f.length,h=!1,k;for(k=a.length-1;k>d.index;k--)j+=l[k]-a[k].value.length;e.length>j&&(e=e.slice(0,j),c=j);if(b.length>d.a){g[0].value=(e+f).slice(0,d.a);c<=d.a&&(p(g[0],c,c),h=!0);b=(e+f).slice(d.a);if(b.length)for(c-=Math.min(d.a,e.length);a[++k];){e=l[k];b+=a[k].value;a.eq(k).val(b.slice(0,e)).change();if(b.length<=e)break;f=a[k].value.length;h||(c<e&&(h=!0,a.eq(k).focus(),p(a[k],c,c)),c-=
f);b=b.slice(e)}h||(a.eq(k).focus(),p(a[k],c,c))}}function h(g){var d=g.type,b=g.data,c=g.data.c,e=b.index,f;m.browser.opera&&"keypress"===d&&(d="keydown");"keydown"===d&&39===g.keyCode&&(f=p(c[0]),f.start===this.value.length&&e!==a.length-1&&(a.eq(e+1).focus(),p(a[e+1],0,0),g.preventDefault()));if("keydown"===d&&(8===g.keyCode||37===g.keyCode))if(f=p(c[0]),f.start===f.end&&0===f.start&&0!==e){f=a.eq(e-1);var h=f.val().length;f.focus();p(f[0],h,h);37===g.keyCode&&g.preventDefault()}if("keyup"===d||
"keydown"===d){if(48>g.keyCode)return;if("keyup"===d&&b.b){b.b=!1;return}if(g.metaKey){b.b=!0;return}f=p(c[0]);f.start===f.end&&(f.start===this.value.length&&e!==a.length-1&&this.value.length===b.a)&&(a.eq(e+1).focus(),p(a[e+1],0,0))}"paste"===d&&c.attr(q,n);("propertychange"===d||"input"===d)&&c.attr(q)!==b.a&&setTimeout(function(){j(c,b);c.attr(q,b.a)},0);"input"===d&&m.browser.opera&&j(c,b)}if(/iPad|iPhone/.test(navigator.platform))return this;var a=this,l=[],n=0;m.browser.opera&&a.attr(q,n);return a.each(function(g){var d=
a.eq(g),b=+d.attr(q);n+=b;l.push(b);d.on("keydown keypress keyup input paste propertychange",{c:d,index:g,a:b},h)})};})(jQuery);
