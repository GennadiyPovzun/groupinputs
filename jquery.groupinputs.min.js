/**
 * GroupInputs v. 0.7.2
 * @author Pavel Kornilov <pk@ostrovok.ru> <lusever@lusever.com>
 * https://github.com/lusever/groupinputs
 * MIT Licensed
 */
(function(a){function b(a,b,c){var d;if(b!==undefined)a.focus(),a.setSelectionRange?a.setSelectionRange(b,c):document.selection&&document.selection.createRange&&(d=a.createTextRange(),d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d.select());else{b=0,c=0;if("selectionStart"in a)b=a.selectionStart,c=a.selectionEnd;else if(a.createTextRange){d=document.selection.createRange();var e=d.duplicate();d.parentElement()===a&&(b=-e.moveStart("character",-1e5),c=b+d.text.length)}return{start:b,end:c}}}a.fn.groupinputs=function(){function e(a,d){var e=a[0].value,f=a.caret().end,g=e.slice(0,f),h=e.slice(f),i=d.maxlength-h.length,j=!1,k,l,m;for(m=b.length-1;m>d.index;m--)i+=c[m]-b[m].value.length;g.length>i?(g=g.slice(0,i),l=i):l=f;if(e.length>d.maxlength){a[0].value=(g+h).slice(0,d.maxlength),l<=d.maxlength&&(a.caret(l,l),j=!0),k=(g+h).slice(d.maxlength);if(k.length){l-=Math.min(d.maxlength,g.length);var n,o;while(b[++m]){n=c[m],k+=b[m].value,b[m].value=k.slice(0,n);if(k.length<=n)break;o=b[m].value.length,j||(l<n&&(j=!0,b.eq(m).trigger("focus").caret(l,l)),l-=o),k=k.slice(n)}}j||b.eq(m).trigger("focus").caret(l,l)}}function f(c){var f=c.type,g=c.data,h=c.data.elem,i=g.index,j=h.caret();a.browser.opera&&(f==="keypress"&&(f="keydown"),f==="input"&&(f+=".opera"));switch(c.keyCode){case 8:f+=".backspace";break;case 37:f+=".left";break;case 39:f+=".right";break;case 46:f+=".delete"}switch(f){case"keydown.right":j.start===this.value.length&&i!==b.length-1&&(b.eq(i+1).focus().caret(0,0),c.preventDefault());break;case"keydown.backspace":case"keydown.left":if(j.start===j.end&&j.start===0&&i!==0){var k=b.eq(i-1),l=k.val().length;k.focus().caret(l,l),f==="keydown.left"&&c.preventDefault()}break;case"keyup":case"keydown":j.start===j.end&&j.start===this.value.length&&i!==b.length-1&&this.value.length===g.maxlength&&b.eq(i+1).focus().caret(0,0);break;case"paste":h.attr("maxlength",d);break;case"propertychange":case"input":h.attr("maxlength")!==g.maxlength&&setTimeout(function(){e(h,g),h.attr("maxlength",g.maxlength)},0);break;case"input.opera":e(h,g)}}if(/iPad|iPhone/.test(navigator.platform))return this;var b=this,c=[],d=0;return b.each(function(a){var e=b.eq(a),g=+e.attr("maxlength");d+=g,c.push(g),e.on("keydown keypress keyup input paste propertychange",{elem:e,index:a,maxlength:g},f)}),a.browser.opera&&b.attr("maxlength",d),this}})(jQuery);